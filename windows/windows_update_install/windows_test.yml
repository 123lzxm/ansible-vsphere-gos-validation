# Copyright 2023-2024 VMware, Inc.
# SPDX-License-Identifier: BSD-2-Clause
---
# Description:
#   This case is to test Microsoft's Windows updates.
#   Install Windows .msu update package.
#
- name: windows_test
  hosts: localhost
  gather_facts: no
  tasks:
    - name: "Test case block"
      block:
        - name: "Set the .msu file name"
          ansible.builtin.set_fact:
            msu_file_path: "C:\\msu\\SSU\\windows10.0-kb5037016-x64-V1.004.msu"
        - name: "Get file base name"
          ansible.builtin.set_fact:
            msu_file_name: "{{ msu_file_path | win_basename }}"
      rescue:
        - name: "Test case failure"
          include_tasks: ../../common/test_rescue.yml
          vars:
            exit_testing_when_fail: true
